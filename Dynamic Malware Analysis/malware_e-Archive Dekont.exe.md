<p>We're going to start testing .exe malware</p>
<p>Artifacts</p>
<p>MD5: 31f840efbb9f5116f6bf1334c1fd55fd</p>
<p>SHA256: c7513589f3f2e02007be1301c2f08c8809ea7526d85d7efcaf3bccf767a38855</p>
<p>File Name: WinRTSynchronizationContextFactoryB.exe</p>
<p>File Name: Win32 EXE</p>
<p>Domain: 5gw4d[.]xyz</p>
<p>You can use malshare or virustotal to find all type of malware</p>

<p> https://www.virustotal.com/gui/file/c7513589f3f2e02007be1301c2f08c8809ea7526d85d7efcaf3bccf767a38855/details </p>

<p>https://malshare.com/sample.php?action=detail&hash=722ef401e5cbb067c5c33faa402774d3c75ef08e0c8cc4d7e66a9cfa53684088</p>


<p>Tools We will be using for this project</p>
<p>RUN: Process Hacker 2, Procmon64, Wireshark and Regshot</p>
<p> each appilcation plays a key role in finding malcious activites </p>

<p>Let start with setting up reg shot and press "1st shot" to get the orginal registry settings before running our malware</p>

<img src="https://github.com/TommyP702/TanPham/assets/169327735/9103806d-3df2-40cd-9c1b-8d1331541fa4" alt="" class="wp-image-5001"/>

<p>Open up wireshark filter to make sure its running on the left of the application there is a fin icon, hover over to click on it to "start capturing packets"</p>
<p>Now lets run the malware (right click admin) make sure its in .exe, rename the .bin if you have to</p>
<img src="https://github.com/TommyP702/TanPham/assets/169327735/bcffcc3c-f24b-4f7a-9ef9-31ebfab615d3" alt="" class="wp-image-5001"/>


<p>Run the malware </p>

<p>Check the child processes under Explorer.exe in "Process Hacker" there we found the malware, hover over to see more detail </p>
<img src="https://github.com/TommyP702/TanPham/assets/169327735/65739134-d263-434c-a061-b831ec0c1569" alt="" class="wp-image-5001"/>
<p>Sometime the child processes is deleted to hide its activites so we're going have to go into procmon to dive deeper.</p>

<p> now lets go back to wireshark and stop capturing click on the red icon</p>

<img src="https://github.com/TommyP702/TanPham/assets/169327735/f76bc2b5-b190-4968-9bff-eaeebe538304" alt="" class="wp-image-5001"/>
``

<p>next we will stop procmon(Process monitor) capture, click on the Squard blue icon. the blue hightlight should be turn off</p>

<img src="https://github.com/TommyP702/TanPham/assets/169327735/68d36039-d32a-488c-88b3-8fd1b793af3c" alt="" class="wp-image-5001"/>


<p>Let go back to Wireshark and process with check our DNS/SMTP filter to see if we can find anything</p>

<img src="https://github.com/TommyP702/TanPham/assets/169327735/9aeffe43-2516-4f0b-a5bc-70e9473af04c" alt="" class="wp-image-5001"/>

<p>On Wireshark I notice in the description its trying to query us2.smtp.mailhostbox.com, to further investigate right click on it and "Follow --> UDP" there we can  </p>

<img src="https://github.com/TommyP702/TanPham/assets/169327735/9aeffe43-2516-4f0b-a5bc-70e9473af04c" alt="" class="wp-image-5001"/>


<p>Now lets go into procmon and in the Process Tree find the malware right click and filter children to include filter </p>

<img src="https://github.com/TommyP702/TanPham/assets/169327735/99f55f8d-5979-4e56-a574-2770b7c0c52d" alt="" class="wp-image-5001"/>

<p> Now we look at the "Operation" to look for createFile there we find the name "AheGmkp.exe"</p>
<p>We also have the has SHA 256 hash c7513589f3f2e02007be1301c2f08c8809ea7526d85d7efcaf3bccf767a38855 , we can go onto Virustotal.com to further our investigation on the malware</p>

<img src="https://github.com/TommyP702/TanPham/assets/169327735/5bc59ce3-0f82-457e-b244-da5ceaaaa40c" alt="" class="wp-image-5001"/>


